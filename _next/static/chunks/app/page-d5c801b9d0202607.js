(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9013:function(e,a,t){Promise.resolve().then(t.bind(t,8948))},5775:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return i}});let n=t(917);t(7437),t(2265);let s=n._(t(5602));function i(e,a){var t;let n={loading:e=>{let{error:a,isLoading:t,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let i={...n,...a};return(0,s.default)({...i,modules:null==(t=i.loadableGenerated)?void 0:t.modules})}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),e.exports=a.default)},1523:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let n=t(8993);function s(e){let{reason:a,children:t}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(a);return t}},5602:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return o}});let n=t(7437),s=t(2265),i=t(1523),l=t(49);function r(e){return{default:e&&"default"in e?e.default:e}}let c={loader:()=>Promise.resolve(r(()=>null)),loading:null,ssr:!0},o=function(e){let a={...c,...e},t=(0,s.lazy)(()=>a.loader().then(r)),o=a.loading;function m(e){let r=o?(0,n.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,c=a.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(l.PreloadCss,{moduleIds:a.modules}):null,(0,n.jsx)(t,{...e})]}):(0,n.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(t,{...e})});return(0,n.jsx)(s.Suspense,{fallback:r,children:c})}return m.displayName="LoadableComponent",m}},49:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"PreloadCss",{enumerable:!0,get:function(){return i}});let n=t(7437),s=t(544);function i(e){let{moduleIds:a}=e;if("undefined"!=typeof window)return null;let t=(0,s.getExpectedRequestStore)("next/dynamic css"),i=[];if(t.reactLoadableManifest&&a){let e=t.reactLoadableManifest;for(let t of a){if(!e[t])continue;let a=e[t].files.filter(e=>e.endsWith(".css"));i.push(...a)}}return 0===i.length?null:(0,n.jsx)(n.Fragment,{children:i.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:t.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},8948:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return y}});var n=t(7437),s=t(2265),i=t(5775),l=t.n(i),r=t(8971),c=t(8347);let o=[{type:"impl",name:"actions__ContractImpl",interface_name:"dojo::contract::interface::IContract"},{type:"interface",name:"dojo::contract::interface::IContract",items:[]},{type:"impl",name:"actions__DeployedContractImpl",interface_name:"dojo::meta::interface::IDeployedResource"},{type:"struct",name:"core::byte_array::ByteArray",members:[{name:"data",type:"core::array::Array::<core::bytes_31::bytes31>"},{name:"pending_word",type:"core::felt252"},{name:"pending_word_len",type:"core::integer::u32"}]},{type:"interface",name:"dojo::meta::interface::IDeployedResource",items:[{type:"function",name:"dojo_name",inputs:[],outputs:[{type:"core::byte_array::ByteArray"}],state_mutability:"view"}]},{type:"impl",name:"ActionsImpl",interface_name:"puppet_vs_gizmo::systems::actions::IActions"},{type:"interface",name:"puppet_vs_gizmo::systems::actions::IActions",items:[{type:"function",name:"create_game",inputs:[{name:"character",type:"core::integer::u8"},{name:"game_id",type:"core::integer::u32"}],outputs:[],state_mutability:"external"},{type:"function",name:"join_game",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[],state_mutability:"external"},{type:"function",name:"throw",inputs:[{name:"game_id",type:"core::integer::u32"},{name:"power",type:"core::integer::u8"}],outputs:[],state_mutability:"external"},{type:"function",name:"player_health",inputs:[{name:"address",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"},{type:"function",name:"game_winner",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"},{type:"function",name:"get_first_player",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"external"},{type:"function",name:"get_second_player",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"external"},{type:"function",name:"get_game_turn",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"}]},{type:"function",name:"dojo_init",inputs:[],outputs:[],state_mutability:"view"},{type:"impl",name:"WorldProviderImpl",interface_name:"dojo::contract::components::world_provider::IWorldProvider"},{type:"struct",name:"dojo::world::iworld::IWorldDispatcher",members:[{name:"contract_address",type:"core::starknet::contract_address::ContractAddress"}]},{type:"interface",name:"dojo::contract::components::world_provider::IWorldProvider",items:[{type:"function",name:"world_dispatcher",inputs:[],outputs:[{type:"dojo::world::iworld::IWorldDispatcher"}],state_mutability:"view"}]},{type:"impl",name:"UpgradeableImpl",interface_name:"dojo::contract::components::upgradeable::IUpgradeable"},{type:"interface",name:"dojo::contract::components::upgradeable::IUpgradeable",items:[{type:"function",name:"upgrade",inputs:[{name:"new_class_hash",type:"core::starknet::class_hash::ClassHash"}],outputs:[],state_mutability:"external"}]},{type:"constructor",name:"constructor",inputs:[]},{type:"event",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded",kind:"struct",members:[{name:"class_hash",type:"core::starknet::class_hash::ClassHash",kind:"data"}]},{type:"event",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Event",kind:"enum",variants:[{name:"Upgraded",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded",kind:"nested"}]},{type:"event",name:"dojo::contract::components::world_provider::world_provider_cpt::Event",kind:"enum",variants:[]},{type:"event",name:"puppet_vs_gizmo::systems::actions::actions::Event",kind:"enum",variants:[{name:"UpgradeableEvent",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Event",kind:"nested"},{name:"WorldProviderEvent",type:"dojo::contract::components::world_provider::world_provider_cpt::Event",kind:"nested"}]}];var m={src:"/Puppet//_next/static/media/back.33c5057d.png"},d={src:"/Puppet//_next/static/media/small_puppet.9a537536.png"},u={src:"/Puppet//_next/static/media/small_gizmo.c7725c5d.png"},p={src:"/Puppet//_next/static/media/select.be584483.png"},h=t(9767);function g(e){let{player1Hp:a,player2Hp:t,throwStone:i,gameId:l,getGameTurn:r,getFirstPlayer:c,getSecondPlayer:o,getPlayerHealth:m,userAddress:d,isPlayer1:u,username:p}=e;return(0,s.useEffect)(()=>{var e;let n=!1,s=!1,c=!1,o=0,p="none",h="none",g=380,y="none",b=0,v=0,f=null,j=document.querySelector(".potion-img-puppet"),x=document.querySelector(".potion-img-gizmo");function N(){j&&x&&j instanceof HTMLImageElement&&x instanceof HTMLImageElement&&a&&t&&(100==a?j.src="https://klanfontan.github.io/heal_full.png":a>60?j.src="https://klanfontan.github.io/heal_almost_full.png":a>10?j.src="https://klanfontan.github.io/heal.png":a<=10&&(j.src="https://klanfontan.github.io/heal_low.png"),100==t?x.src="https://klanfontan.github.io/heal_full.png":t>60?x.src="https://klanfontan.github.io/heal_almost_full.png":t>10?x.src="https://klanfontan.github.io/heal.png":t<=10&&(x.src="https://klanfontan.github.io/heal_low.png"))}function _(){return Math.floor(7*Math.random())-3}function w(){if("puppet"==p){let e=document.querySelector(".puppet-stars");e&&e instanceof HTMLImageElement&&(e.style.opacity="0")}else{let e=document.querySelector(".gizmo-stars");e&&e instanceof HTMLImageElement&&(e.style.opacity="0")}}function k(){let e=document.querySelector(".cloud-animation-gizmo"),a=document.querySelector(".cloud-animation-puppet");e&&e instanceof HTMLDivElement&&(e.style.opacity="1"),a&&a instanceof HTMLDivElement&&(a.style.opacity="0")}function P(){let e=document.querySelector(".cloud-animation-puppet"),a=document.querySelector(".cloud-animation-gizmo");e&&e instanceof HTMLDivElement&&(e.style.opacity="1"),a&&a instanceof HTMLDivElement&&(a.style.opacity="0")}function S(){let e=document.querySelector(".cloud-animation-puppet"),a=document.querySelector(".cloud-animation-gizmo");e&&e instanceof HTMLDivElement&&(e.style.opacity="0"),a&&a instanceof HTMLDivElement&&(a.style.opacity="0")}function E(){let e=document.querySelector(".wind-img");if(e&&e instanceof HTMLImageElement){if("puppet"==p)switch(v){case 0:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_0.png",S();break;case 1:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_minus_1.png",P();break;case 2:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_minus_2.png",P();break;case 3:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_minus_3.png",P();break;case -1:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_1.png",k();break;case -2:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_2.png",k();break;case -3:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_3.png",k()}else switch(v){case 0:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_0.png",S();break;case 1:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_1.png",k();break;case 2:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_2.png",k();break;case 3:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_plus_3.png",k();break;case -1:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_minus_1.png",P();break;case -2:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_minus_2.png",P();break;case -3:e.src="https://klanfontan.github.io/game/Puppet-main/gamecode/wind_minus_3.png",P()}}}null===(e=document.querySelector(".game-screen"))||void 0===e||e.classList.add("game-bg"),setTimeout(()=>{!function(){let e=document.querySelector(".preloader-video");e&&e instanceof HTMLVideoElement&&(e.style.opacity="0",setTimeout(()=>{e.remove()},1e3))}()},2200),v=_(),E(),r(l).then(e=>{if(1==(f=e)?(h="gizmo",console.log("Current Player: ",p="puppet")):2==f&&(h="puppet",console.log("Current Player: ",p="gizmo")),u){console.log(y="puppet");let e=0,n=0;z&&A&&(a&&(b=a,e=a>=10?a/15*61.5:0),t&&(b=t,n=t>=10?t/15*61.5:0),2===f?(c=!0,M()):c=!1,z.style.width="".concat(e,"px"),A.style.width="".concat(n,"px"))}else{console.log(y="gizmo");let e=0,n=0;z&&A&&(a&&(b=a,e=a>=10?a/15*61.5:0),t&&(b=t,n=t>=10?t/15*61.5:0),1===f?(c=!0,M()):c=!1,z.style.width="".concat(e,"px"),A.style.width="".concat(n,"px"))}}),N();let C=null,z=null,A=null;function L(){("puppet"!=y||1!==f||s)&&("gizmo"!=y||2!==f||s)||(n=!0,o=0,function e(){if(n){o+=1;let a=g+10;"puppet"==p?(document.querySelector(".player-svg-puppet"),C=document.querySelector(".purple-puppet")):(document.querySelector(".player-svg-gizmo"),C=document.querySelector(".purple-gizmo")),C&&(C.style.strokeDashoffset=a.toString(),C.style.transition="stroke-dashoffset 0.1s ease",g=a),o<10&&setTimeout(e,100)}}())}function T(){n&&(n=!1,(C="puppet"==p?document.querySelector(".purple-puppet"):document.querySelector(".purple-gizmo"))&&(C.style.strokeDashoffset="380",g=380),o>10&&(o=10),I(h,p,o),q(),v=_(),E(),N())}async function M(){setTimeout(async()=>{let e=await r(l);if(console.log("Current Chain Turn: ",e),c&&d&&(u&&1===e||!u&&2===e)){let e=await m(d);console.log("New User Health: ",e),b>(null!=e?e:0)?(console.log("User Health: ",b=null!=e?e:b),I(h,p,6+v)):I(h,p,(.5>Math.random()?Math.floor(4*Math.random()):9+Math.floor(2*Math.random()))+v),q(),v=_(),E(),N()}else M()},13e3)}function I(e,a,t){let n=document.querySelector(".coconut-wrapper"),r=document.querySelector(".player-".concat(a," .player-img")),c=document.createElement("div");c.id="coconut",c.className="coconut-".concat(a),n&&n.appendChild(c),console.log(t),r&&r instanceof HTMLImageElement&&(r.src="https://klanfontan.github.io/game/Puppet-main/gamecode/".concat(a,".gif")),t>=6+v&&t<=7+v?(n&&n.classList.add("animate-coconut-".concat(a)),y==a&&i(l,1),setTimeout(()=>{!function(){if("puppet"==p){let e=document.querySelector(".puppet-stars");e&&e instanceof HTMLImageElement&&(e.style.opacity="1",setTimeout(()=>w(),3e3))}else{let e=document.querySelector(".gizmo-stars");e&&e instanceof HTMLImageElement&&(e.style.opacity="1",setTimeout(()=>w(),3e3))}}()},1500),function(e){let a=document.querySelector(".health-bar-".concat(e," .health-bar-inner"));if(a&&a instanceof HTMLElement){let t=parseFloat(getComputedStyle(a).width),n=document.querySelector(".player-".concat(e," .player-img")),i=document.querySelector(".player-svg-puppet"),l=document.querySelector(".player-svg-gizmo");t>61.5?a.style.width="".concat(t-61.5,"px"):(a.style.width="0px",s=!0,n&&n instanceof HTMLImageElement&&(n.src="https://klanfontan.github.io/game/Puppet-main/gamecode/".concat(e,"_dead.gif"),n.style.paddingTop="75px"),i&&i instanceof SVGSVGElement&&i.classList.add("hidden"),l&&l instanceof SVGSVGElement&&l.classList.add("hidden")),a.style.transition="width 0.5s ease"}}(e)):t>=8+v?(n&&n.classList.add("animate-coconut-overthrow-".concat(a)),y==a&&i(l,0)):t<=1+v?(n&&n.classList.add("animate-coconut-barricade-".concat(a)),y==a&&i(l,0)):t<=5+v&&(n&&n.classList.add("animate-coconut-underthrow-".concat(a)),y==a&&i(l,0)),setTimeout(()=>{r&&r instanceof HTMLImageElement&&(r.src="https://klanfontan.github.io/assets/".concat(a,"_frames/frame_00.png"))},300),setTimeout(()=>{n&&(n.removeChild(c),n.classList.remove("animate-coconut-".concat(a),"animate-coconut-overthrow-".concat(a),"animate-coconut-underthrow-".concat(a),"animate-coconut-barricade-".concat(a)))},750)}function q(){if(!s){let e=document.querySelector(".player-svg-".concat(p));e&&e.classList.add("hidden"),h="puppet"===h?"gizmo":"puppet",f=1===f?2:1,(p="puppet"===p?"gizmo":"puppet")==y?c=!1:(c=!0,M());let a=document.querySelector(".player-svg-".concat(p));a&&a.classList.remove("hidden")}}z=document.querySelector(".health-bar-puppet .health-bar-inner"),A=document.querySelector(".health-bar-gizmo .health-bar-inner"),!s&&(C="puppet"===p?document.querySelector(".purple-puppet"):document.querySelector(".purple-gizmo"))&&C instanceof HTMLElement&&C.classList.add("hidden"),/Mobi|Android/i.test(navigator.userAgent)?(document.addEventListener("touchstart",L),document.addEventListener("touchend",T)):(document.addEventListener("mousedown",L),document.addEventListener("mouseup",T)),document.addEventListener("contextmenu",function(e){e.preventDefault()},!1)},[]),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"intro-container",children:(0,n.jsx)("video",{className:"preloader-video",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/intro.mp4",autoPlay:!0,muted:!0,playsInline:!0})}),(0,n.jsxs)("div",{className:"game-board",children:[(0,n.jsxs)("div",{className:"cloud-animation-container",children:[(0,n.jsx)("div",{className:"cloud-animation-puppet",children:(0,n.jsx)("img",{className:"cloud-animation-puppet-gif",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/cloud.gif",alt:"cloud"})}),(0,n.jsx)("div",{className:"cloud-animation-gizmo",children:(0,n.jsx)("img",{className:"cloud-animation-gizmo-gif",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/cloud.gif",alt:"cloud"})})]}),(0,n.jsxs)("div",{className:"bars-container",children:[(0,n.jsxs)("div",{className:"puppet-bar",children:[(0,n.jsx)("div",{className:"potion left-potion",children:(0,n.jsx)("img",{className:"potion-img-puppet",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/potion.png",alt:"potion"})}),(0,n.jsxs)("div",{className:"health-container",children:[(0,n.jsxs)("div",{className:"nickname-container",children:[(0,n.jsx)("div",{className:"tag",children:"Puppet"}),(0,n.jsx)("div",{className:"nickname",children:u?p:"Puppet Bro"})]}),(0,n.jsx)("div",{className:"health-bar health-bar-puppet",children:(0,n.jsx)("div",{className:"health-bar-inner"})})]}),(0,n.jsx)("div",{className:"avatar avatar-puppet",children:(0,n.jsx)("img",{className:"avatar-img",src:"https://klanfontan.github.io/img/square_puppet.png",alt:"avatar"})})]}),(0,n.jsx)("div",{className:"versus-container",children:(0,n.jsx)("img",{className:"versus-img",src:"https://klanfontan.github.io/img/versus.svg",alt:"versus"})}),(0,n.jsxs)("div",{className:"gizmo-bar",children:[(0,n.jsx)("div",{className:"avatar avatar-gizmo",children:(0,n.jsx)("img",{className:"avatar-img",src:"https://klanfontan.github.io/img/square_gizmo.png",alt:"avatar"})}),(0,n.jsxs)("div",{className:"health-container health-container-gizmo",children:[(0,n.jsxs)("div",{className:"nickname-container nickname-container-gizmo",children:[(0,n.jsx)("div",{className:"nickname",children:u?"Gizmo Bro":p}),(0,n.jsx)("div",{className:"tag tag-gizmo",children:"Gizmo"})]}),(0,n.jsx)("div",{className:"health-bar health-bar-gizmo gizmo-health-bar-reverse",children:(0,n.jsx)("div",{className:"health-bar-inner"})})]}),(0,n.jsx)("div",{className:"potion right-potion",children:(0,n.jsx)("img",{className:"potion-img-gizmo",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/potion.png",alt:"potion"})})]})]}),(0,n.jsx)("div",{className:"wind-container",children:(0,n.jsx)("img",{className:"wind-img",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/wind.png",alt:"wind"})}),(0,n.jsxs)("div",{className:"players-container",children:[(0,n.jsxs)("div",{className:"player player-puppet",children:[(0,n.jsx)("img",{className:"puppet-stars",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/Stars_Puppet.gif",alt:"stars"}),(0,n.jsx)("img",{className:"player-img",src:"https://klanfontan.github.io/assets/puppet_frames/frame_00.png",alt:"avatar"}),(0,n.jsxs)("svg",{className:"player-svg-puppet",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 100 100",children:[(0,n.jsx)("path",{className:"grey",d:"M10,20   A20,20 0 1,1 40,60",style:{fill:"none"}}),(0,n.jsx)("path",{className:"purple-puppet",d:"M10,20   A20,20 0 1,1 40,60",style:{fill:"none",strokeDashoffset:380}})]})]}),(0,n.jsxs)("div",{className:"player player-gizmo",children:[(0,n.jsx)("img",{className:"gizmo-stars",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/Stars_Gizmo.gif",alt:"stars"}),(0,n.jsx)("img",{className:"player-img",src:"https://klanfontan.github.io/assets/gizmo_frames/frame_00.png",alt:"avatar"}),(0,n.jsxs)("svg",{className:"player-svg-gizmo",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 100 100",children:[(0,n.jsx)("path",{className:"grey",d:"M10,20   A20,20 0 1,1 40,60",style:{fill:"none"}}),(0,n.jsx)("path",{className:"purple-gizmo",d:"M10,20   A20,20 0 1,1 40,60",style:{fill:"none",strokeDashoffset:380}})]})]})]}),(0,n.jsx)("div",{className:"coconut-wrapper"})]})]})}l()(()=>t.e(921).then(t.bind(t,4921)),{loadableGenerated:{webpack:()=>[4921]},ssr:!1});var y=()=>{let{data:e,isLoading:a,isError:t}=(0,r.Ov)({blockIdentifier:"latest"}),{connect:i,connectors:l}=(0,r.$4)(),{disconnect:y}=(0,r.qL)(),[b,v]=(0,s.useState)(!0),[f,j]=(0,s.useState)(!1),[x,N]=(0,s.useState)(!0),[_,w]=(0,s.useState)(!1),[k,P]=(0,s.useState)(null),[S,E]=(0,s.useState)(!1),[C,z]=(0,s.useState)("NEW LOBBY"),[A,L]=(0,s.useState)(0),[T,M]=(0,s.useState)(1),[I,q]=(0,s.useState)(!1),[G,O]=(0,s.useState)(),[F,D]=(0,s.useState)(!1),[H,U]=(0,s.useState)(null),[B,R]=(0,s.useState)(null),[V,W]=(0,s.useState)(null),[Y,X]=(0,s.useState)(null),[Q,Z]=(0,s.useState)([]),[J,K]=(0,s.useState)([]);var $=4e4;let{address:ee}=(0,r.mA)(),{account:ea}=(0,r.mA)(),{isLoading:et,isError:en,error:es,data:ei}=(0,r.KQ)({address:ee,watch:!0}),el="0x0409f17fbe2145d007c6d18731fa9919e943a60230fe5c2647f702615a49e4f9",[er,ec]=(0,s.useState)(0),{contract:eo}=(0,r.cq)({abi:o,address:el}),em=(0,s.useMemo)(()=>{if(!ee||!eo)return console.error("Contract or userAddress is undefined"),console.log("Contract:",eo),console.log("User Address:",ee),[]},[eo,ee,er]),{send:ed,data:eu,isPending:ep}=(0,r.pQ)({calls:em}),{data:eh,status:eg,isLoading:ey,isError:eb,error:ev}=(0,r.VS)({hash:null==eu?void 0:eu.transaction_hash,watch:!0});(0,s.useMemo)(()=>new c.Gf({nodeUrl:h.env.NEXT_PUBLIC_RPC_URL}),[]);let[ef,ej]=(0,s.useState)([]);(0,s.useRef)(0);let{data:ex}=(0,r.Ov)({refetchInterval:3e3});(0,s.useEffect)(()=>{document.title="Puppet vs Gizmo"},[]),(0,s.useEffect)(()=>{(async()=>{if(ee&&A){let e=await eC(A),a=await eE(A);if(e===ee){let e=await eS(ee);U(a?await eS(a):null),R(e)}else{let a=await eS(ee),t=e?await eS(e):null;U(a),R(t)}}})()},[ee,A]),(0,s.useEffect)(()=>{(async()=>{ee&&A&&(await eE(A)==ee?W(!0):W(!1))})()},[ee,A]);let eN=async()=>{if(eo&&ee){z("Waiting for Opponent");try{if("Puppet"===k?M(1):"Gizmo"===k&&M(2),await e_(T,await eT()))for(;;){let e=await eE(A),a=await eC(A);if(e&&a){if(e!=a&&await eS(e)==100&&await eS(a)==100){setTimeout(async()=>{U(100),R(100),W(!0),D(!0)},6e3);break}await new Promise(e=>setTimeout(e,1e3))}}}catch(e){console.error("Error sending transaction:",e)}}},e_=(0,s.useCallback)(async(e,a)=>{if(!ea)return!1;q(!0),O(void 0);try{let{transaction_hash:t}=await ea.execute([{contractAddress:el,entrypoint:"create_game",calldata:[e,a]}]);return O(t),!0}catch(e){return console.error(e),!1}finally{q(!1)}},[ea]),ew=(0,s.useCallback)(async e=>{if(!ea)return!1;q(!0),O(void 0);try{let{transaction_hash:a}=await ea.execute([{contractAddress:el,entrypoint:"join_game",calldata:[e]}]);return O(a),!0}catch(e){return console.error(e),!1}finally{q(!1)}},[ea]),ek=(0,s.useCallback)(async(e,a)=>{if(!ea)return!1;q(!0),O(void 0);try{let{transaction_hash:t}=await ea.execute([{contractAddress:el,entrypoint:"throw",calldata:[e,a]}]);return O(t),!0}catch(e){return console.error(e),!1}finally{q(!1)}},[ea]),eP=(0,s.useCallback)(async e=>{if(!ea)return null;q(!0),O(void 0);try{let a=await ea.callContract({contractAddress:el,entrypoint:"game_winner",calldata:[e]});return console.log("Game winner:",Number(a[0])),Number(a[0])}catch(e){return console.error("Error calling game_winner:",e),null}finally{q(!1)}},[ea]),eS=(0,s.useCallback)(async e=>{if(!ea)return null;q(!0),O(void 0);try{let a=await ea.callContract({contractAddress:el,entrypoint:"player_health",calldata:[e]});return console.log("Player health:",Number(a[0])),Number(a[0])}catch(e){return console.error("Error calling player_health:",e),null}finally{q(!1)}},[ea]),eE=(0,s.useCallback)(async e=>{if(!ea)return null;q(!0),O(void 0);try{let a=await ea.callContract({contractAddress:el,entrypoint:"get_first_player",calldata:[e]});return console.log("First player:",a),a[0]}catch(e){return console.error("Error calling get_first_player:",e),null}finally{q(!1)}},[ea]),eC=(0,s.useCallback)(async e=>{if(!ea)return null;q(!0),O(void 0);try{let a=await ea.callContract({contractAddress:el,entrypoint:"get_second_player",calldata:[e]});return console.log("Second player:",a),a[0]}catch(e){return console.error("Error calling get_second_player:",e),null}finally{q(!1)}},[ea]),ez=(0,s.useCallback)(async e=>{if(!ea)return null;q(!0),O(void 0);try{let a=await ea.callContract({contractAddress:el,entrypoint:"get_game_turn",calldata:[e]});return console.log("Game turn:",Number(a[0])),Number(a[0])}catch(e){return console.error("Error calling get_game_turn:",e),null}finally{q(!1)}},[ea]),eA=async function(e){var a=Number(e);if(L(a),eo&&ee)try{if(await eC(a)!=ee&&await eE(a)==ee||await eE(a)!=ee&&await eC(a)==ee){D(!0);return}if(await ew(a))for(;;){let e=await eE(a),t=await eC(a);if(e&&t){if(e!=t){setTimeout(async()=>{if(ee&&a){if(t===ee){let a=await eS(ee),t=e?await eS(e):null;U(t),R(a)}else{let e=await eS(ee),a=t?await eS(t):null;U(e),R(a)}}W(!1),D(!0)},6e3);break}await new Promise(e=>setTimeout(e,1e3))}}}catch(e){console.error("Error sending transaction:",e)}},eL=async()=>{for(var e=1;e<20;e++)if(0==Q.length){if(await eP($)!=0)continue;var a=await eE($),t=await eC($);if("0x0"!=a&&t==a&&a&&t)Q.push(a),J.push($.toString()),$++,console.log("Hey: "+Q[e-1]);else if("0x0"!=a&&t!=a&&a&&t){$++;continue}else{$=4e4;break}}},eT=async()=>{let e=4e4;for(;;){if("0x0"===await eE(e))return e;e++}};return(0,s.useEffect)(()=>{let e=setTimeout(()=>{j(!0)},2e3);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{N(!1)},3e3);return()=>clearTimeout(e)},[]),(0,n.jsx)("div",{className:"game-screen ".concat("Puppet"===k?"puppet-bg":"Gizmo"===k?"gizmo-bg":""),style:{opacity:1},children:_?(0,n.jsx)("div",{className:"screen",children:S?(0,n.jsx)(n.Fragment,{children:F?(0,n.jsx)(g,{player1Hp:H,player2Hp:B,throwStone:ek,gameId:A,getGameTurn:ez,getFirstPlayer:eE,getSecondPlayer:eC,getPlayerHealth:eS,userAddress:null!=ee?ee:null,isPlayer1:null!=V&&V,username:Y}):(0,n.jsxs)(n.Fragment,{children:["Puppet"===k&&(0,n.jsxs)("div",{className:"puppet-page",children:[(0,n.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"back-button",children:(0,n.jsx)("img",{src:m.src,alt:"Back",onClick:()=>E(!1)})}),(0,n.jsxs)("div",{className:"enemy-select-container",children:[(0,n.jsxs)("div",{className:"enemy-selector",children:[(0,n.jsx)("h4",{className:"player-text",id:"player-text",children:Y}),(0,n.jsx)("img",{src:d.src,alt:"Puppet"}),(0,n.jsx)("h3",{children:"PUPPET"}),(0,n.jsx)("p",{className:"player-description",children:"55 (67%)"})]}),(0,n.jsxs)("div",{className:"victims-container",children:[(0,n.jsxs)("div",{className:"victims-header-container",children:[(0,n.jsx)("h2",{children:"SELECT LOBBY"}),(0,n.jsx)("div",{className:"victims-header-button",onClick:eN,children:C})]}),(0,n.jsxs)("div",{className:"victim-selector",children:[Q.length>=1&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[0]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[0]})]})}),Q.length>=2&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[1]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[1]})]})}),Q.length>=3&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[2]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[2]})]})}),Q.length>=4&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[3]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[3]})]})}),Q.length>=5&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[4]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[4]})]})}),Q.length>=6&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[5]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[5]})]})}),Q.length>=7&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[6]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[6]})]})}),Q.length>=8&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[7]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[7]})]})}),Q.length>=9&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[8]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[8]})]})}),Q.length>=10&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container gizmo-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Gizmo"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[9]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[9]})]})})]})]})]})]})]}),"Gizmo"===k&&(0,n.jsxs)("div",{className:"gizmo-page",children:[(0,n.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"back-button",children:(0,n.jsx)("img",{src:m.src,alt:"Back",onClick:()=>E(!1)})}),(0,n.jsxs)("div",{className:"enemy-select-container",children:[(0,n.jsxs)("div",{className:"enemy-selector",children:[(0,n.jsx)("h4",{className:"player-text",id:"player-text",children:Y}),(0,n.jsx)("img",{src:u.src,alt:"Gizmo"}),(0,n.jsx)("h3",{children:"GIZMO"}),(0,n.jsx)("p",{className:"player-description",children:"55 (67%)"})]}),(0,n.jsxs)("div",{className:"victims-container",children:[(0,n.jsxs)("div",{className:"victims-header-container",children:[(0,n.jsx)("h2",{children:"SELECT LOBBY"}),(0,n.jsx)("div",{className:"victims-header-button",onClick:eN,children:C})]}),(0,n.jsxs)("div",{className:"victim-selector",children:[Q.length>=1&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[0]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[0]})]})}),Q.length>=2&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[1]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[1]})]})}),Q.length>=3&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[2]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[2]})]})}),Q.length>=4&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[3]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[3]})]})}),Q.length>=5&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[4]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[4]})]})}),Q.length>=6&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[5]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[5]})]})}),Q.length>=7&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[6]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[6]})]})}),Q.length>=8&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[7]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[7]})]})}),Q.length>=9&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[0]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[8]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[8]})]})}),Q.length>=10&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"lobby-item-container",onClick:()=>eA(J[1]),children:[(0,n.jsx)("div",{className:"lobby-image-container puppet-avatar",children:(0,n.jsx)("div",{className:"lobby-item-amount",children:"Puppet"})}),(0,n.jsx)("div",{className:"lobby-name",children:Array.from(Q[9]).slice(0,10).join("")}),(0,n.jsx)("div",{className:"lobby-percent",children:J[9]})]})})]})]})]})]})]})]})}):(0,n.jsxs)("div",{className:"character-select-screen",children:[(0,n.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"back-button",children:(0,n.jsx)("img",{src:m.src,alt:"Back",onClick:()=>w(!1)})}),(0,n.jsxs)("div",{className:"character-select-container",children:[(0,n.jsxs)("div",{id:"puppet-selector",className:"character-selector",onClick:()=>{P("Puppet"),E(!0),eL()},children:[(0,n.jsx)("img",{src:d.src,alt:"Puppet"}),(0,n.jsx)("h3",{children:"PUPPET"}),(0,n.jsx)("p",{className:"character-description",children:"55 (67%)"})]}),(0,n.jsxs)("div",{id:"gizmo-selector",className:"character-selector",onClick:()=>{P("Gizmo"),E(!0),eL()},children:[(0,n.jsx)("img",{src:u.src,alt:"Gizmo"}),(0,n.jsx)("h3",{children:"GIZMO"}),(0,n.jsx)("p",{className:"character-description",children:"55 (67%)"})]})]}),(0,n.jsx)("div",{className:"select-container",children:(0,n.jsx)("img",{className:"select-svg",src:p.src,alt:"Select"})})]})]})}):(0,n.jsxs)(n.Fragment,{children:[x&&(0,n.jsx)("div",{className:"preloader-container ".concat(f?"fade-out-preloader":""),children:(0,n.jsxs)("div",{className:"preloader-inner-container",children:[(0,n.jsxs)("div",{className:"preloader-logos-container",children:[(0,n.jsx)("img",{src:"https://klanfontan.github.io/game/Puppet-main/gamecode/LogoBmd.svg",alt:"BMD"}),(0,n.jsx)("img",{src:"https://klanfontan.github.io/game/Puppet-main/gamecode/LogoRealms.svg",alt:"Realms.world"})]}),(0,n.jsx)("div",{className:"preloader-text",children:"v.0.71 from 31 Jan 2025"})]})}),(0,n.jsx)("div",{className:"new-game-container",children:(0,n.jsxs)("div",{className:"new-game-inner-container",children:[(0,n.jsx)("img",{className:"new-game-preview",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/GamePreview.png",alt:"Preview"}),(0,n.jsxs)("div",{className:"new-game-buttons",children:[(0,n.jsxs)("div",{className:"new-game-sound-button-container",children:[(0,n.jsx)("img",{className:"new-game-sound-button-image",src:"https://klanfontan.github.io/game/Puppet-main/gamecode/SoundOn.png",alt:"SFX"}),(0,n.jsx)("button",{className:"new-game-sound-button",children:"SOUND ON"})]}),l.map((e,a)=>(0,n.jsx)("button",{className:"connect-button",onClick:async()=>{let a=l[0];await i({connector:e}),ee&&setTimeout(()=>{var e;w(!0),null===(e=a.username())||void 0===e||e.then(e=>X(e))},500)},children:ee?"START GAME":"CONNECT"},a))]})]})})]})})}}},function(e){e.O(0,[255,125,917,971,117,744],function(){return e(e.s=9013)}),_N_E=e.O()}]);