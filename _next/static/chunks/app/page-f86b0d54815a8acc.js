(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8095:function(e,t,a){Promise.resolve().then(a.bind(a,2522))},7568:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let s=a(4981);a(5320),a(8978);let r=s._(a(6080));function n(e,t){var a;let s={loading:e=>{let{error:t,isLoading:a,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e);let n={...s,...t};return(0,r.default)({...n,modules:null==(a=n.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7208:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let s=a(8165);function r(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new s.BailoutToCSRError(t);return a}},6080:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let s=a(5320),r=a(8978),n=a(7208),i=a(7893);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},c=function(e){let t={...o,...e},a=(0,r.lazy)(()=>t.loader().then(l)),c=t.loading;function d(e){let l=c?(0,s.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(i.PreloadCss,{moduleIds:t.modules}):null,(0,s.jsx)(a,{...e})]}):(0,s.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(r.Suspense,{fallback:l,children:o})}return d.displayName="LoadableComponent",d}},7893:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return n}});let s=a(5320),r=a(6334);function n(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,r.getExpectedRequestStore)("next/dynamic css"),n=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));n.push(...t)}}return 0===n.length?null:(0,s.jsx)(s.Fragment,{children:n.map(e=>(0,s.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},2522:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(5320),r=a(8978),n=a(7568),i=a.n(n),l=a(5452),o=a(8439);let c=[{name:"actions__ContractImpl",type:"impl",interface_name:"dojo::contract::interface::IContract"},{name:"dojo::contract::interface::IContract",type:"interface",items:[]},{name:"actions__DeployedContractImpl",type:"impl",interface_name:"dojo::meta::interface::IDeployedResource"},{name:"core::byte_array::ByteArray",type:"struct",members:[{name:"data",type:"core::array::Array::<core::bytes_31::bytes31>"},{name:"pending_word",type:"core::felt252"},{name:"pending_word_len",type:"core::integer::u32"}]},{name:"dojo::meta::interface::IDeployedResource",type:"interface",items:[{name:"dojo_name",type:"function",inputs:[],outputs:[{type:"core::byte_array::ByteArray"}],state_mutability:"view"}]},{name:"ActionsImpl",type:"impl",interface_name:"puppet_vs_gizmo::systems::actions::IActions"},{name:"puppet_vs_gizmo::systems::actions::IActions",type:"interface",items:[{name:"create_game",type:"function",inputs:[{name:"character",type:"core::integer::u8"},{name:"game_id",type:"core::integer::u32"}],outputs:[],state_mutability:"external"},{name:"join_game",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[],state_mutability:"external"},{name:"throw",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"},{name:"power",type:"core::integer::u8"}],outputs:[],state_mutability:"external"},{name:"player_health",type:"function",inputs:[{name:"address",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"},{name:"game_winner",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"},{name:"get_first_player",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"external"},{name:"get_second_player",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"external"}]},{name:"dojo_init",type:"function",inputs:[],outputs:[],state_mutability:"view"},{name:"WorldProviderImpl",type:"impl",interface_name:"dojo::contract::components::world_provider::IWorldProvider"},{name:"dojo::world::iworld::IWorldDispatcher",type:"struct",members:[{name:"contract_address",type:"core::starknet::contract_address::ContractAddress"}]},{name:"dojo::contract::components::world_provider::IWorldProvider",type:"interface",items:[{name:"world_dispatcher",type:"function",inputs:[],outputs:[{type:"dojo::world::iworld::IWorldDispatcher"}],state_mutability:"view"}]},{name:"UpgradeableImpl",type:"impl",interface_name:"dojo::contract::components::upgradeable::IUpgradeable"},{name:"dojo::contract::components::upgradeable::IUpgradeable",type:"interface",items:[{name:"upgrade",type:"function",inputs:[{name:"new_class_hash",type:"core::starknet::class_hash::ClassHash"}],outputs:[],state_mutability:"external"}]},{name:"constructor",type:"constructor",inputs:[]},{kind:"struct",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded",type:"event",members:[{kind:"data",name:"class_hash",type:"core::starknet::class_hash::ClassHash"}]},{kind:"enum",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Event",type:"event",variants:[{kind:"nested",name:"Upgraded",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded"}]},{kind:"enum",name:"dojo::contract::components::world_provider::world_provider_cpt::Event",type:"event",variants:[]},{kind:"enum",name:"puppet_vs_gizmo::systems::actions::actions::Event",type:"event",variants:[{kind:"nested",name:"UpgradeableEvent",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Event"},{kind:"nested",name:"WorldProviderEvent",type:"dojo::contract::components::world_provider::world_provider_cpt::Event"}]}];var d={src:"/Puppet//_next/static/media/puppet_preview.82f41b7d.png"},m={src:"/Puppet//_next/static/media/gizmo_preview.1253c5ed.png"},p={src:"/Puppet//_next/static/media/versus.b298df6b.png"},h={src:"/Puppet//_next/static/media/back.33c5057d.png"},f={src:"/Puppet//_next/static/media/small_puppet.9a537536.png"},u={src:"/Puppet//_next/static/media/small_gizmo.c7725c5d.png"},g={src:"/Puppet//_next/static/media/select.be584483.png"},_=a(9767);function y(){return(0,r.useEffect)(()=>{let e=document.getElementById("gameCanvas"),t=null==e?void 0:e.getContext("2d",{alpha:!1});e.width=1280,e.height=522;let a={x:15,y:e.height-350,width:256,height:316,hitboxHeight:316/6,hp:100,maxHp:100},s={x:e.width-290,y:e.height-350,width:256,height:316,hitboxHeight:316/6,hp:100,maxHp:100},r=performance.now(),n=!1,i=1,l=!0,o=null,c=!1,d=0,m={x:543,y:315,width:187.5,height:180},p=["/assets/puppet_frames_death/frame_00.png","/assets/puppet_frames_death/frame_01.png","/assets/puppet_frames_death/frame_02.png","/assets/puppet_frames_death/frame_03.png","/assets/puppet_frames_death/frame_04.png","/assets/puppet_frames_death/frame_05.png","/assets/puppet_frames_death/frame_06.png","/assets/puppet_frames_death/frame_07.png","/assets/puppet_frames_death/frame_08.png","/assets/puppet_frames_death/frame_09.png","/assets/puppet_frames_death/frame_10.png","/assets/puppet_frames_death/frame_11.png","/assets/puppet_frames_death/frame_12.png","/assets/puppet_frames_death/frame_13.png","/assets/puppet_frames_death/frame_14.png","/assets/puppet_frames_death/frame_15.png"],h=["/assets/gizmo_frames_death/frame_00.png","/assets/gizmo_frames_death/frame_01.png","/assets/gizmo_frames_death/frame_02.png","/assets/gizmo_frames_death/frame_03.png","/assets/gizmo_frames_death/frame_04.png","/assets/gizmo_frames_death/frame_05.png","/assets/gizmo_frames_death/frame_06.png","/assets/gizmo_frames_death/frame_07.png","/assets/gizmo_frames_death/frame_08.png","/assets/gizmo_frames_death/frame_09.png","/assets/gizmo_frames_death/frame_10.png","/assets/gizmo_frames_death/frame_11.png","/assets/gizmo_frames_death/frame_12.png","/assets/gizmo_frames_death/frame_13.png","/assets/gizmo_frames_death/frame_14.png","/assets/gizmo_frames_death/frame_15.png"],f=[],u=[],g=new Image;g.src="background.png";let _=new Image;_.src="emptyHpBar.png";let y=new Image;y.src="/assets/puppet_frames/frame_00.png";let x=new Image;x.src="/assets/gizmo_frames/frame_00.png";let w=new Image;w.src="backButton.png";let b={x:50,y:55,width:125,height:45},v=new Image;v.src="../../../img/versus.svg";let j=new Image;j.src="../../../img/square_gizmo.png";let E=new Image;E.src="../../../img/square_puppet.png";let P="Gizmo",C=a.hp,I=s.hp,N=!1,A=!1,k=0,z=0;function F(){z=12*Math.random()-6}function T(e,a,s,r,n){t&&(t.beginPath(),t.moveTo(e,a),t.lineTo(e+s,a-n/2),t.lineTo(e+s,a+n/2),t.closePath(),t.fill(),"#FFFFFF"!==t.fillStyle&&(t.lineWidth=2,t.strokeStyle="#FFFFFF",t.stroke()))}let O=document.createElement("canvas"),S=O.getContext("2d");function M(){t&&t.drawImage(O,0,0)}O.width=e.width,O.height=e.height;let R=0,L=0,B=0,D=0;function U(e){let r=!Q&&(e===a&&N||e===s&&A),n=Date.now()-k;if(r&&n<500){if(!t)return;t.globalAlpha=Math.floor(n/100)%2==0?.5:1}else{if(e===a&&(N=!1),e===s&&(A=!1),!t)return;t.globalAlpha=1}e===a?t.drawImage(y,e.x,e.y,e.width,e.height):t.drawImage(x,e.x,e.y,e.width,e.height);let i=performance.now();if(i-en>50&&(er=(er+1)%es.length,en=i),e===a){if(B>0){let e=i-B;e<1e3?R=1-e/1e3:(R=0,B=0)}t.globalAlpha=R}else{if(D>0){let e=i-D;e<1e3?L=1-e/1e3:(L=0,D=0)}t.globalAlpha=L}let l=e.x+(e.width-125)/2,o=e.y-31.25+60;t.drawImage(es[er],l,o,125,125),t.globalAlpha=1}function Y(){let r=e.width-350-150;if(!t)return;t.fillStyle="white",t.font="28px Fortnite",t.textAlign="right",t.shadowColor="rgba(100, 13, 13, 1)",t.shadowOffsetX=0,t.shadowOffsetY=4,t.fillText(P,460,45),t.shadowOffsetX=0,t.shadowOffsetY=0,t.fillStyle="rgba(232, 44, 64, 1)";let n=e.width/2-t.measureText(P).width-260;G(n,29,70,30,5),t.fillStyle="white",t.font="18px Fortnite",t.textAlign="center",t.shadowColor="rgba(0, 0, 0, 0.1)",t.shadowOffsetX=0,t.shadowOffsetY=3,t.fillText("PUPPET",n+35,46),t.shadowOffsetX=0,t.shadowOffsetY=0,C>a.hp&&(C-=.5)<a.hp&&(C=a.hp),t.fillStyle="white",G(150,70,350,12,6),t.fillStyle="red",C>0&&G(152,72,C/a.maxHp*346,8,4),t.fillStyle="white",t.font="28px Fortnite",t.textAlign="left",t.shadowColor="rgba(100, 13, 13, 1)",t.shadowOffsetX=0,t.shadowOffsetY=4,t.fillText(P,e.width-460,45),t.shadowOffsetX=0,t.shadowOffsetY=0,t.fillStyle="rgba(137, 223, 111, 1)";let i=t.measureText(P).width,l=e.width/2+i+190;G(l,29,70,30,5),t.fillStyle="white",t.font="18px Fortnite",t.textAlign="center",t.shadowColor="rgba(0, 0, 0, 0.1)",t.shadowOffsetX=0,t.shadowOffsetY=3,t.fillText("GIZMO",l+35,46),t.shadowOffsetX=0,t.shadowOffsetY=0,I>s.hp&&(I-=.5)<s.hp&&(I=s.hp),t.fillStyle="white",G(r,70,350,12,6),t.fillStyle="red",I>0&&G(r+2+346*(1-I/s.maxHp),72,I/s.maxHp*346,8,4)}function G(e,a,s,r,n){t&&(t.beginPath(),t.moveTo(e+n,a),t.lineTo(e+s-n,a),t.quadraticCurveTo(e+s,a,e+s,a+n),t.lineTo(e+s,a+r-n),t.quadraticCurveTo(e+s,a+r,e+s-n,a+r),t.lineTo(e+n,a+r),t.quadraticCurveTo(e,a+r,e,a+r-n),t.lineTo(e,a+n),t.quadraticCurveTo(e,a,e+n,a),t.closePath(),t.fill())}function X(){i=1===i?2:1,l=!0,F(),2===i&&2===i&&l&&(s.hp<s.maxHp/2&&!em[1].used?setTimeout(()=>{setTimeout(()=>{ei=!1,Z()},500)},500):(ei=!0,setTimeout(()=>{ei=!1,Z()},800*Math.random()+400)))}e.addEventListener("mousedown",e=>{l&&!o&&1===i&&(c=!0,ei=!0)}),e.addEventListener("mouseup",e=>{c&&l&&1===i&&(c=!1,ei=!1,Z())});let q=["/assets/puppet_frames/frame_00.png","/assets/puppet_frames/frame_01.png","/assets/puppet_frames/frame_02.png","/assets/puppet_frames/frame_03.png","/assets/puppet_frames/frame_04.png","/assets/puppet_frames/frame_05.png","/assets/puppet_frames/frame_06.png","/assets/puppet_frames/frame_07.png","/assets/puppet_frames/frame_08.png","/assets/puppet_frames/frame_09.png","/assets/puppet_frames/frame_10.png","/assets/puppet_frames/frame_11.png"],H=["/assets/gizmo_frames/frame_00.png","/assets/gizmo_frames/frame_01.png","/assets/gizmo_frames/frame_02.png","/assets/gizmo_frames/frame_03.png","/assets/gizmo_frames/frame_04.png","/assets/gizmo_frames/frame_05.png","/assets/gizmo_frames/frame_06.png","/assets/gizmo_frames/frame_07.png","/assets/gizmo_frames/frame_08.png","/assets/gizmo_frames/frame_09.png","/assets/gizmo_frames/frame_10.png","/assets/gizmo_frames/frame_11.png"],W=0;function V(e){return Promise.all(e.map(e=>new Promise((t,a)=>{let s=new Image;s.src=e,s.onload=t,s.onerror=a})))}function Z(){let e;let t=.5*z,r=3.2+d;1===i?(e=J(q,y,"/assets/puppet_frames/frame_00.png"),o={x:a.x+a.width-210,y:a.y+a.height/2+20,speedX:r+t,speedY:-(1.5*r)}):(e=J(H,x,"/assets/gizmo_frames/frame_00.png"),o={x:s.x+210,y:s.y+s.height/2+20,speedX:-r+t,speedY:-(1.5*r)}),d=0,l=!1,setTimeout(()=>{e()},350)}function J(e,t,a){W=0;let s=performance.now(),r=!0;return requestAnimationFrame(function a(n){r&&(n-s>=25&&(t.src=e[W],W=(W+1)%e.length,s=n),requestAnimationFrame(a))}),function(){r=!1,t.src=a}}Promise.all([V(q),V(H)]).then(()=>{$()}).catch(e=>{console.error("Ошибка загрузки кадров:",e)});let Q=!1,K=!0;function $(){if(K)return;let c=performance.now(),p=(c-r)/1e3;if(r=c,t){let r,c,h,g,_;t.clearRect(0,0,e.width,e.height),M(),ei&&d<8&&l&&(d+=6*p),o&&(o.x+=o.speedX*p*100,o.y+=o.speedY*p*100,o.speedY+=.17*p*100,(o.x>e.width||o.x<0||o.y>e.height)&&(o=null,X())),function(){if(o){var r,l,c,d,p,h,g,_;if(o.x>=m.x&&o.x<=m.x+m.width&&o.y>=m.y&&o.y<=m.y+m.height||(r=o.x,l=o.y,c=m.x,d=m.y,p=m.x+m.width/2,h=m.y-80,g=m.x+m.width,.1>Math.abs(Math.abs((p-c)*((_=m.y)-d)-(g-c)*(h-d))/2-(Math.abs((c-r)*(h-l)-(p-r)*(d-l))/2+Math.abs((p-r)*(_-l)-(g-r)*(h-l))/2+Math.abs((g-r)*(d-l)-(c-r)*(_-l))/2)))){o=null,X();return}let v=1===i?s:a,j=v.y+(v.height-v.hitboxHeight)/2,E=Math.max(v.x,Math.min(o.x,v.x+v.width)),P=Math.max(j,Math.min(o.y,j+v.hitboxHeight));if(10>=Math.sqrt((o.x-E)**2+(o.y-P)**2)){if(v.hp-=15,v.hp<=0&&(v.hp=0,v.height=v.height/1.5,v.y=e.height-v.height-34),o=null,v===s?(A=!0,D=performance.now()):(N=!0,B=performance.now()),k=Date.now(),0!==v.hp||n)X();else{Q=!0,n=!0;let r=1===i?"Puppet":"Gizmo",l=1===i?2:1;if(N=!1,A=!1,!t)return;t.globalAlpha=1,cancelAnimationFrame($),function(r,n){console.log("Starting death animation for player",r);let i=0,l=0,o=1===r?f:u;if(0===o.length){console.error("No death animation frames loaded!"),n&&n();return}!function c(){if(i>=o.length){if(++l<6){i=0,requestAnimationFrame(()=>setTimeout(c,25));return}console.log("Animation complete after",6,"plays"),n&&n();return}(1===r?y:x).src=o[i].src,t&&(t.clearRect(0,0,e.width,e.height),M(),U(a),U(s),Y(),i++,requestAnimationFrame(()=>setTimeout(c,25)))}()}(l,()=>{setTimeout(()=>{(function(a){Q=!0;let s="Puppet"===a?"#E82C40":"#89DF6F",r=0,n=10,i=Date.now();ee=!0,function l(){let o=Math.min((Date.now()-i)/2e3,1),c=o<.5?2*o*o:-1+(4-2*o)*o;r=c,n=10+38*c,t&&(t.clearRect(0,0,e.width,e.height),t.fillStyle="rgba(".concat(parseInt(s.slice(1,3),16),", ").concat(parseInt(s.slice(3,5),16),", ").concat(parseInt(s.slice(5,7),16),", ").concat(r,")"),t.fillRect(0,0,e.width,e.height),t.fillStyle="rgba(255, 255, 255, ".concat(r,")"),t.font="".concat(n,"px Fortnite"),t.textAlign="center",t.textBaseline="middle",t.fillText("Game Over! ".concat(a," wins!"),e.width/2,e.height/2),ee&&(t.globalAlpha=r,t.drawImage(w,b.x,b.y,b.width,b.height),t.globalAlpha=1),o<1&&requestAnimationFrame(l))}()})(r)},0)})}}}}(),t.globalAlpha=1,U(a),U(s),o&&o&&t&&(t.fillStyle="gray",t.beginPath(),t.arc(o.x,o.y,10,0,2*Math.PI),t.fill()),(Q||n)&&(ep=Math.max(0,ep-.05)),t.globalAlpha=ep,Y(),em.forEach((e,a)=>{if(!e.used){if(1===a)t&&(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.scale(-1,1),t.drawImage(ed,-e.width/2,-e.height/2,e.width,e.height),t.restore());else{if(!t)return;t.drawImage(ed,e.x,e.y,e.width,e.height)}}}),function(){let a=(e.width-200)/2;if(!t)return;t.shadowColor="#03043E",t.shadowOffsetX=0,t.shadowOffsetY=4,t.shadowBlur=0,t.fillStyle="#B3B4FE",t.fillRect(a,125,200,40),t.shadowColor="transparent",t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0;let s=Math.max(-6,Math.min(6,z));t.fillStyle="#FFFFFF",t.fillRect(a+100,125,s/6*100,40),t.fillStyle="#0003FA",t.font="28px Fortnite",t.textAlign="center",t.fillText("Wind",e.width/2,146),t.fillStyle=s<0?"#FFFFFF":"#B3B4FE",T(a-20-35,145,40,0,20),t.fillStyle=s>0?"#FFFFFF":"#B3B4FE",T(a+200+20+35,145,-40,0,20)}(),ec(t),Q||eo(t),l&&t&&(1===i?(r=a.x+a.width/1.55,c=a.y+150,g=(h=5*Math.PI/4+Math.PI-Math.PI/6)-d/8*(_=.85*Math.PI)):(r=s.x+s.width/2.5,c=s.y+150,g=(h=3*Math.PI/4+Math.PI/6)+d/8*(_=.85*Math.PI)),t.beginPath(),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=30,t.arc(r,c,125,h,h+(1===i?-_:_),1===i),t.stroke(),ei&&(t.beginPath(),t.strokeStyle="white",t.lineWidth=30,t.arc(r,c,125,h,g,1===i),t.stroke())),t.globalAlpha=1,Q&&null===o||requestAnimationFrame($)}}let ee=!1,et=3,ea=["/assets/gizmo_stars/frame_00.png","/assets/gizmo_stars/frame_01.png","/assets/gizmo_stars/frame_02.png","/assets/gizmo_stars/frame_03.png","/assets/gizmo_stars/frame_04.png","/assets/gizmo_stars/frame_05.png","/assets/gizmo_stars/frame_06.png","/assets/gizmo_stars/frame_07.png","/assets/gizmo_stars/frame_08.png","/assets/gizmo_stars/frame_09.png","/assets/gizmo_stars/frame_10.png"],es=[],er=0,en=0;Promise.all([new Promise(e=>g.onload=e),new Promise(e=>_.onload=e),new Promise(e=>y.onload=e),new Promise(e=>x.onload=e)]).then(()=>{(function(){let e=0,t=p.length+h.length;function a(){e++,console.log("Loaded ".concat(e,"/").concat(t," death frames"))}p.forEach(e=>{let t=new Image;t.onload=a,t.src=e,f.push(t)}),h.forEach(e=>{let t=new Image;t.onload=a,t.src=e,u.push(t)})})(),ea.forEach(e=>{let t=new Image;t.src=e,es.push(t)}),S&&(S&&S.drawImage(g,0,0,e.width,e.height),ec(S),eo(S)),F(),function a(){t&&(t.clearRect(0,0,e.width,e.height),t.fillStyle="rgba(232, 44, 64, 1)",t.fillRect(0,0,e.width,e.height),t.fillStyle="white",t.font="100px Fortnite",t.textAlign="center",t.textBaseline="middle",t.fillText(et.toString(),e.width/2,e.height/2),et>1?(et--,setTimeout(a,1e3)):setTimeout(()=>{et=3,K=!1,$()},1e3))}()}),e.addEventListener("click",t=>{if(ee){let r=e.getBoundingClientRect(),c=t.clientX-r.left,m=t.clientY-r.top;c>=b.x&&c<=b.x+b.width&&m>=b.y&&m<=b.y+b.height&&(a.hp=a.maxHp,s.hp=s.maxHp,i=1,l=!0,o=null,d=0,Q=!1,n=!1,$(),ee=!1)}});let ei=!1;function el(t,a){let s=e.getBoundingClientRect();return t>=s.left&&t<=s.right&&a>=s.top&&a<=s.bottom}function eo(t){let a=e.width/2;t.drawImage(v,a-37.5,30,75,63)}function ec(t){let a=e.width/2+100-30,s=e.width/2-100-65;t.drawImage(j,a,10,100,100),t.drawImage(E,s,10,100,100)}e.addEventListener("touchstart",t=>{let a=t.changedTouches[0],s=a.clientX,r=a.clientY;if(ee&&(e.getBoundingClientRect(),s>=b.x&&s<=b.x+b.width&&r>=b.y&&r<=b.y+b.height)){window.location.href="../../../index.html";return}let n=!1;if(em.forEach((e,t)=>{if(!e.used&&s>=e.x&&s<=e.x+e.width&&r>=e.y&&r<=e.y+e.height){n=!0;return}}),!n&&el(s,r)){if(t.preventDefault(),1!==i)return;!l||o||1!==i||(ei=!0)}}),e.addEventListener("touchend",e=>{let t=e.changedTouches[0];if(el(t.clientX,t.clientY)){if(e.preventDefault(),1!==i)return;ei&&(ei=!1,Z())}}),e.addEventListener("touchmove",e=>{e.preventDefault()}),new FontFace("Fortnite","url(frt.otf)").load().then(function(e){document.fonts.add(e),t&&(t.font="48px Fortnite")}).catch(function(e){console.error("Ошибка загрузки шрифта:",e)});let ed=new Image;ed.src="potion.png";let em=[{x:65,y:35,width:50,height:70,used:!1},{x:e.width-115,y:35,width:50,height:70,used:!1}];e.addEventListener("click",t=>{t.preventDefault();let a=e.getBoundingClientRect(),s=t.clientX-a.left,r=t.clientY-a.top;em.forEach((e,t)=>{!e.used&&s>=e.x&&s<=e.x+e.width&&r>=e.y&&(e.y,e.height)})});let ep=1},[]),(0,s.jsx)("canvas",{id:"gameCanvas",width:"1280",height:"522"})}i()(()=>a.e(959).then(a.bind(a,2959)),{loadableGenerated:{webpack:()=>[2959]},ssr:!1});var x=()=>{let{data:e,isLoading:t,isError:a}=(0,l.Ov)({blockIdentifier:"latest"}),{connect:n,connectors:i}=(0,l.$4)(),{disconnect:x}=(0,l.qL)(),[w,b]=(0,r.useState)(!0),[v,j]=(0,r.useState)(!1),[E,P]=(0,r.useState)(!1),[C,I]=(0,r.useState)(null),[N,A]=(0,r.useState)(!1),[k,z]=(0,r.useState)(0),[F,T]=(0,r.useState)(0),[O,S]=(0,r.useState)(!1),[M,R]=(0,r.useState)(),[L,B]=(0,r.useState)(!1),D=async()=>{if(Q&&Y)try{await eh(),B(!0)}catch(e){console.error("Error sending transaction:",e)}},U=async()=>{if(Q&&Y)try{await ef(),B(!0)}catch(e){console.error("Error sending transaction:",e)}},{address:Y}=(0,l.mA)(),{account:G}=(0,l.mA)(),{isLoading:X,isError:q,error:H,data:W}=(0,l.KQ)({address:Y,watch:!0}),V="0x0409f17fbe2145d007c6d18731fa9919e943a60230fe5c2647f702615a49e4f9",[Z,J]=(0,r.useState)(0),{contract:Q}=(0,l.cq)({abi:c,address:V}),K=(0,r.useMemo)(()=>{if(!Y||!Q)return console.error("Contract or userAddress is undefined"),console.log("Contract:",Q),console.log("User Address:",Y),[]},[Q,Y,Z]),{send:$,data:ee,isPending:et}=(0,l.pQ)({calls:K}),{data:ea,status:es,isLoading:er,isError:en,error:ei}=(0,l.VS)({hash:null==ee?void 0:ee.transaction_hash,watch:!0}),el=(0,r.useMemo)(()=>new o.Gf({nodeUrl:_.env.NEXT_PUBLIC_RPC_URL}),[]),[eo,ec]=(0,r.useState)([]),ed=(0,r.useRef)(0),{data:em}=(0,l.Ov)({refetchInterval:3e3}),ep=(0,r.useCallback)(async(e,t)=>{if(!(t<=ed.current))try{let a=ed.current+1,s=await el.getEvents({address:e.address,from_block:{block_number:a},to_block:{block_number:t},chunk_size:500});s&&s.events&&ec(e=>[...e,...s.events]),ed.current=t}catch(e){console.error("Error checking for events:",e)}},[el]);(0,r.useEffect)(()=>{Q&&em&&ep(Q,em)},[Q,em,ep]),(0,r.useMemo)(()=>[...eo].reverse().slice(0,5),[eo]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{j(!0),setTimeout(()=>b(!1),1e3)},2e3);return()=>clearTimeout(e)},[]);let eh=(0,r.useCallback)(async()=>{G&&(S(!0),R(void 0),G.execute([{contractAddress:V,entrypoint:"create_game",calldata:[1,4]}]).then(e=>{let{transaction_hash:t}=e;return R(t)}).catch(e=>console.error(e)).finally(()=>S(!1)))},[G]),ef=(0,r.useCallback)(async()=>{G&&(S(!0),R(void 0),G.execute([{contractAddress:V,entrypoint:"join_game",calldata:[4]}]).then(e=>{let{transaction_hash:t}=e;return R(t)}).catch(e=>console.error(e)).finally(()=>S(!1)))},[G]);return(0,r.useCallback)(async()=>{if(G){S(!0),R(void 0);try{let e=await G.callContract({contractAddress:V,entrypoint:"player_health",calldata:["0x792cf6265c21b922c740dad0c0d4fdb330747833f5d45a155e62557194319e1"]});return console.log("Player health:",e),e}catch(e){return console.error("Error calling player_health:",e),null}finally{S(!1)}}},[G]),(0,r.useCallback)(async()=>{if(G){S(!0),R(void 0);try{let e=await G.callContract({contractAddress:V,entrypoint:"get_first_player",calldata:[2]});console.log("First player:",e)}catch(e){console.error("Error calling get_first_player:",e)}finally{S(!1)}}},[G]),(0,s.jsx)("div",{className:"game-screen ".concat("Puppet"===C?"puppet-bg":"Gizmo"===C?"gizmo-bg":""),style:{opacity:v?1:0},children:E?(0,s.jsx)("div",{className:"screen",children:N?(0,s.jsx)(s.Fragment,{children:L?(0,s.jsx)(y,{}):(0,s.jsxs)(s.Fragment,{children:["Puppet"===C&&(0,s.jsxs)("div",{className:"puppet-page",children:[(0,s.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,s.jsxs)("div",{className:"game-container",children:[(0,s.jsx)("div",{className:"back-button",children:(0,s.jsx)("img",{src:h.src,alt:"Back",onClick:()=>A(!1)})}),(0,s.jsxs)("div",{className:"enemy-select-container",children:[(0,s.jsxs)("div",{className:"enemy-selector",children:[(0,s.jsx)("h4",{className:"player-text",id:"player-text",children:"Player"}),(0,s.jsx)("img",{src:f.src,alt:"Puppet"}),(0,s.jsx)("h3",{children:"PUPPET"}),(0,s.jsx)("p",{className:"player-description",children:"55 (67%)"})]}),(0,s.jsxs)("div",{className:"victims-container",children:[(0,s.jsx)("h2",{children:"SELECT YOUR ACTION"}),(0,s.jsxs)("div",{className:"victim-selector",children:[(0,s.jsx)("button",{className:"create-button",onClick:D,children:"CREATE GAME"}),(0,s.jsx)("button",{className:"join-button",onClick:U,children:"JOIN GAME"})]})]})]})]})]}),"Gizmo"===C&&(0,s.jsxs)("div",{className:"gizmo-page",children:[(0,s.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,s.jsxs)("div",{className:"game-container",children:[(0,s.jsx)("div",{className:"back-button",children:(0,s.jsx)("img",{src:h.src,alt:"Back",onClick:()=>A(!1)})}),(0,s.jsxs)("div",{className:"enemy-select-container",children:[(0,s.jsxs)("div",{className:"enemy-selector",children:[(0,s.jsx)("h4",{className:"player-text",id:"player-text",children:"Player"}),(0,s.jsx)("img",{src:u.src,alt:"Gizmo"}),(0,s.jsx)("h3",{children:"GIZMO"}),(0,s.jsx)("p",{className:"player-description",children:"55 (67%)"})]}),(0,s.jsxs)("div",{className:"victims-container",children:[(0,s.jsx)("h2",{children:"SELECT YOUR ACTION"}),(0,s.jsxs)("div",{className:"victim-selector",children:[(0,s.jsx)("button",{className:"create-button",onClick:D,children:"CREATE GAME"}),(0,s.jsx)("button",{className:"join-button",onClick:U,children:"JOIN GAME"})]})]})]})]})]})]})}):(0,s.jsxs)("div",{className:"character-select-screen",children:[(0,s.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,s.jsxs)("div",{className:"game-container",children:[(0,s.jsx)("div",{className:"back-button",children:(0,s.jsx)("img",{src:h.src,alt:"Back",onClick:()=>P(!1)})}),(0,s.jsxs)("div",{className:"character-select-container",children:[(0,s.jsxs)("div",{id:"puppet-selector",className:"character-selector",onClick:()=>{I("Puppet"),A(!0)},children:[(0,s.jsx)("img",{src:f.src,alt:"Puppet"}),(0,s.jsx)("h3",{children:"PUPPET"}),(0,s.jsx)("p",{className:"character-description",children:"55 (67%)"})]}),(0,s.jsxs)("div",{id:"gizmo-selector",className:"character-selector",onClick:()=>{I("Gizmo"),A(!0)},children:[(0,s.jsx)("img",{src:u.src,alt:"Gizmo"}),(0,s.jsx)("h3",{children:"GIZMO"}),(0,s.jsx)("p",{className:"character-description",children:"55 (67%)"})]})]}),(0,s.jsx)("div",{className:"select-container",children:(0,s.jsx)("img",{className:"select-svg",src:g.src,alt:"Select"})})]})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"character left-character",children:[(0,s.jsx)("div",{className:"character-name",children:"Puppet"}),(0,s.jsx)("img",{src:d.src,className:"App-left-character",alt:"Left Character"})]}),(0,s.jsxs)("div",{className:"vs-container",children:[(0,s.jsx)("img",{src:p.src,className:"App-vs",alt:"VS"}),(0,s.jsxs)("div",{className:"play-button-container",children:[(0,s.jsx)("button",{className:"start-game-button-text",onClick:()=>{Y?(alert("Wallet Address: ".concat(Y)),P(!0)):alert("Please connect your wallet")},children:"START GAME"}),i.map((e,t)=>(0,s.jsx)("button",{className:"play-button",onClick:()=>n({connector:e}),children:Y?"CONNECTED":"CONNECT"},t))]})]}),(0,s.jsxs)("div",{className:"character right-character",children:[(0,s.jsx)("div",{className:"character-name",children:"Gizmo"}),(0,s.jsx)("img",{src:m.src,className:"App-right-character",alt:"Right Character"})]})]})})}}},function(e){e.O(0,[541,652,412,274,936,744],function(){return e(e.s=8095)}),_N_E=e.O()}]);