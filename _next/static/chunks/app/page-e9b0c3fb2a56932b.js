(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8095:function(e,t,a){Promise.resolve().then(a.bind(a,2522))},7568:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let n=a(4981);a(5320),a(8978);let s=n._(a(6080));function r(e,t){var a;let n={loading:e=>{let{error:t,isLoading:a,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let r={...n,...t};return(0,s.default)({...r,modules:null==(a=r.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7208:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let n=a(8165);function s(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return a}},6080:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let n=a(5320),s=a(8978),r=a(7208),c=a(7893);function i(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},l=function(e){let t={...o,...e},a=(0,s.lazy)(()=>t.loader().then(i)),l=t.loading;function d(e){let i=l?(0,n.jsx)(l,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(c.PreloadCss,{moduleIds:t.modules}):null,(0,n.jsx)(a,{...e})]}):(0,n.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(a,{...e})});return(0,n.jsx)(s.Suspense,{fallback:i,children:o})}return d.displayName="LoadableComponent",d}},7893:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return r}});let n=a(5320),s=a(6334);function r(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,s.getExpectedRequestStore)("next/dynamic css"),r=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));r.push(...t)}}return 0===r.length?null:(0,n.jsx)(n.Fragment,{children:r.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},2522:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var n=a(5320),s=a(8978),r=a(7568),c=a.n(r),i=a(5452),o=a(8439);let l=[{name:"actions__ContractImpl",type:"impl",interface_name:"dojo::contract::interface::IContract"},{name:"dojo::contract::interface::IContract",type:"interface",items:[]},{name:"actions__DeployedContractImpl",type:"impl",interface_name:"dojo::meta::interface::IDeployedResource"},{name:"core::byte_array::ByteArray",type:"struct",members:[{name:"data",type:"core::array::Array::<core::bytes_31::bytes31>"},{name:"pending_word",type:"core::felt252"},{name:"pending_word_len",type:"core::integer::u32"}]},{name:"dojo::meta::interface::IDeployedResource",type:"interface",items:[{name:"dojo_name",type:"function",inputs:[],outputs:[{type:"core::byte_array::ByteArray"}],state_mutability:"view"}]},{name:"ActionsImpl",type:"impl",interface_name:"puppet_vs_gizmo::systems::actions::IActions"},{name:"puppet_vs_gizmo::systems::actions::IActions",type:"interface",items:[{name:"create_game",type:"function",inputs:[{name:"character",type:"core::integer::u8"},{name:"game_id",type:"core::integer::u32"}],outputs:[],state_mutability:"external"},{name:"join_game",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[],state_mutability:"external"},{name:"throw",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"},{name:"power",type:"core::integer::u8"}],outputs:[],state_mutability:"external"},{name:"player_health",type:"function",inputs:[{name:"address",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"},{name:"game_winner",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::integer::u8"}],state_mutability:"external"},{name:"get_first_player",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"external"},{name:"get_second_player",type:"function",inputs:[{name:"game_id",type:"core::integer::u32"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"external"}]},{name:"dojo_init",type:"function",inputs:[],outputs:[],state_mutability:"view"},{name:"WorldProviderImpl",type:"impl",interface_name:"dojo::contract::components::world_provider::IWorldProvider"},{name:"dojo::world::iworld::IWorldDispatcher",type:"struct",members:[{name:"contract_address",type:"core::starknet::contract_address::ContractAddress"}]},{name:"dojo::contract::components::world_provider::IWorldProvider",type:"interface",items:[{name:"world_dispatcher",type:"function",inputs:[],outputs:[{type:"dojo::world::iworld::IWorldDispatcher"}],state_mutability:"view"}]},{name:"UpgradeableImpl",type:"impl",interface_name:"dojo::contract::components::upgradeable::IUpgradeable"},{name:"dojo::contract::components::upgradeable::IUpgradeable",type:"interface",items:[{name:"upgrade",type:"function",inputs:[{name:"new_class_hash",type:"core::starknet::class_hash::ClassHash"}],outputs:[],state_mutability:"external"}]},{name:"constructor",type:"constructor",inputs:[]},{kind:"struct",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded",type:"event",members:[{kind:"data",name:"class_hash",type:"core::starknet::class_hash::ClassHash"}]},{kind:"enum",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Event",type:"event",variants:[{kind:"nested",name:"Upgraded",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded"}]},{kind:"enum",name:"dojo::contract::components::world_provider::world_provider_cpt::Event",type:"event",variants:[]},{kind:"enum",name:"puppet_vs_gizmo::systems::actions::actions::Event",type:"event",variants:[{kind:"nested",name:"UpgradeableEvent",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Event"},{kind:"nested",name:"WorldProviderEvent",type:"dojo::contract::components::world_provider::world_provider_cpt::Event"}]}];var d={src:"/Puppet//_next/static/media/puppet_preview.82f41b7d.png"},u={src:"/Puppet//_next/static/media/gizmo_preview.1253c5ed.png"},p={src:"/Puppet//_next/static/media/versus.b298df6b.png"},m={src:"/Puppet//_next/static/media/back.33c5057d.png"},y={src:"/Puppet//_next/static/media/small_puppet.9a537536.png"},h={src:"/Puppet//_next/static/media/small_gizmo.c7725c5d.png"},f={src:"/Puppet//_next/static/media/select.be584483.png"},g=a(9767);function _(){return(0,n.jsx)("div",{children:(0,n.jsx)("div",{id:"game-container"})})}c()(()=>a.e(959).then(a.bind(a,2959)),{loadableGenerated:{webpack:()=>[2959]},ssr:!1});var j=()=>{let{data:e,isLoading:t,isError:a}=(0,i.Ov)({blockIdentifier:"latest"}),{connect:r,connectors:c}=(0,i.$4)(),{disconnect:j}=(0,i.qL)(),[x,v]=(0,s.useState)(!0),[b,N]=(0,s.useState)(!1),[C,E]=(0,s.useState)(!1),[k,P]=(0,s.useState)(null),[w,A]=(0,s.useState)(!1),[I,O]=(0,s.useState)(0),[S,T]=(0,s.useState)(0),[R,U]=(0,s.useState)(!1),[M,L]=(0,s.useState)(),[G,z]=(0,s.useState)(!1),D=async()=>{if(K&&W)try{await em(),z(!0)}catch(e){console.error("Error sending transaction:",e)}},B=async()=>{if(K&&W)try{await ey(),z(!0)}catch(e){console.error("Error sending transaction:",e)}},{address:W}=(0,i.mA)(),{account:F}=(0,i.mA)(),{isLoading:V,isError:Y,error:q,data:H}=(0,i.KQ)({address:W,watch:!0}),J="0x0409f17fbe2145d007c6d18731fa9919e943a60230fe5c2647f702615a49e4f9",[Q,Z]=(0,s.useState)(0),{contract:K}=(0,i.cq)({abi:l,address:J}),X=(0,s.useMemo)(()=>{if(!W||!K)return console.error("Contract or userAddress is undefined"),console.log("Contract:",K),console.log("User Address:",W),[]},[K,W,Q]),{send:$,data:ee,isPending:et}=(0,i.pQ)({calls:X}),{data:ea,status:en,isLoading:es,isError:er,error:ec}=(0,i.VS)({hash:null==ee?void 0:ee.transaction_hash,watch:!0}),ei=(0,s.useMemo)(()=>new o.Gf({nodeUrl:g.env.NEXT_PUBLIC_RPC_URL}),[]),[eo,el]=(0,s.useState)([]),ed=(0,s.useRef)(0),{data:eu}=(0,i.Ov)({refetchInterval:3e3}),ep=(0,s.useCallback)(async(e,t)=>{if(!(t<=ed.current))try{let a=ed.current+1,n=await ei.getEvents({address:e.address,from_block:{block_number:a},to_block:{block_number:t},chunk_size:500});n&&n.events&&el(e=>[...e,...n.events]),ed.current=t}catch(e){console.error("Error checking for events:",e)}},[ei]);(0,s.useEffect)(()=>{K&&eu&&ep(K,eu)},[K,eu,ep]),(0,s.useMemo)(()=>[...eo].reverse().slice(0,5),[eo]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{N(!0),setTimeout(()=>v(!1),1e3)},2e3);return()=>clearTimeout(e)},[]);let em=(0,s.useCallback)(async()=>{F&&(U(!0),L(void 0),F.execute([{contractAddress:J,entrypoint:"create_game",calldata:[1,4]}]).then(e=>{let{transaction_hash:t}=e;return L(t)}).catch(e=>console.error(e)).finally(()=>U(!1)))},[F]),ey=(0,s.useCallback)(async()=>{F&&(U(!0),L(void 0),F.execute([{contractAddress:J,entrypoint:"join_game",calldata:[4]}]).then(e=>{let{transaction_hash:t}=e;return L(t)}).catch(e=>console.error(e)).finally(()=>U(!1)))},[F]),eh=(0,s.useCallback)(async()=>{F&&(U(!0),L(void 0),F.callContract({contractAddress:J,entrypoint:"game_winner",calldata:[2]}))},[F]);return(0,n.jsx)("div",{className:"game-screen ".concat("Puppet"===k?"puppet-bg":"Gizmo"===k?"gizmo-bg":""),style:{opacity:b?1:0},children:C?(0,n.jsx)("div",{className:"screen",children:w?(0,n.jsx)(n.Fragment,{children:G?(0,n.jsx)(_,{}):(0,n.jsxs)(n.Fragment,{children:["Puppet"===k&&(0,n.jsxs)("div",{className:"puppet-page",children:[(0,n.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"back-button",children:(0,n.jsx)("img",{src:m.src,alt:"Back",onClick:()=>A(!1)})}),(0,n.jsxs)("div",{className:"enemy-select-container",children:[(0,n.jsxs)("div",{className:"enemy-selector",children:[(0,n.jsx)("h4",{className:"player-text",id:"player-text",children:"Player"}),(0,n.jsx)("img",{src:y.src,alt:"Puppet"}),(0,n.jsx)("h3",{children:"PUPPET"}),(0,n.jsx)("p",{className:"player-description",children:"55 (67%)"})]}),(0,n.jsxs)("div",{className:"victims-container",children:[(0,n.jsx)("h2",{children:"SELECT YOUR ACTION"}),(0,n.jsxs)("div",{className:"victim-selector",children:[(0,n.jsx)("button",{className:"create-button",onClick:D,children:"CREATE GAME"}),(0,n.jsx)("button",{className:"join-button",onClick:B,children:"JOIN GAME"})]})]})]})]})]}),"Gizmo"===k&&(0,n.jsxs)("div",{className:"gizmo-page",children:[(0,n.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"back-button",children:(0,n.jsx)("img",{src:m.src,alt:"Back",onClick:()=>A(!1)})}),(0,n.jsxs)("div",{className:"enemy-select-container",children:[(0,n.jsxs)("div",{className:"enemy-selector",children:[(0,n.jsx)("h4",{className:"player-text",id:"player-text",children:"Player"}),(0,n.jsx)("img",{src:h.src,alt:"Gizmo"}),(0,n.jsx)("h3",{children:"GIZMO"}),(0,n.jsx)("p",{className:"player-description",children:"55 (67%)"})]}),(0,n.jsxs)("div",{className:"victims-container",children:[(0,n.jsx)("h2",{children:"SELECT YOUR ACTION"}),(0,n.jsxs)("div",{className:"victim-selector",children:[(0,n.jsx)("button",{className:"create-button",onClick:D,children:"CREATE GAME"}),(0,n.jsx)("button",{className:"join-button",onClick:B,children:"JOIN GAME"}),(0,n.jsx)("button",{className:"game-check-button",onClick:async()=>{await eh()},children:"Check Game Status"})]})]})]})]})]})]})}):(0,n.jsxs)("div",{className:"character-select-screen",children:[(0,n.jsx)("div",{className:"rotate-message",children:"PLEASE TURN YOUR DEVICE INTO LANDSCAPE MODE."}),(0,n.jsxs)("div",{className:"game-container",children:[(0,n.jsx)("div",{className:"back-button",children:(0,n.jsx)("img",{src:m.src,alt:"Back",onClick:()=>E(!1)})}),(0,n.jsxs)("div",{className:"character-select-container",children:[(0,n.jsxs)("div",{id:"puppet-selector",className:"character-selector",onClick:()=>{P("Puppet"),A(!0)},children:[(0,n.jsx)("img",{src:y.src,alt:"Puppet"}),(0,n.jsx)("h3",{children:"PUPPET"}),(0,n.jsx)("p",{className:"character-description",children:"55 (67%)"})]}),(0,n.jsxs)("div",{id:"gizmo-selector",className:"character-selector",onClick:()=>{P("Gizmo"),A(!0)},children:[(0,n.jsx)("img",{src:h.src,alt:"Gizmo"}),(0,n.jsx)("h3",{children:"GIZMO"}),(0,n.jsx)("p",{className:"character-description",children:"55 (67%)"})]})]}),(0,n.jsx)("div",{className:"select-container",children:(0,n.jsx)("img",{className:"select-svg",src:f.src,alt:"Select"})})]})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"character left-character",children:[(0,n.jsx)("div",{className:"character-name",children:"Puppet"}),(0,n.jsx)("img",{src:d.src,className:"App-left-character",alt:"Left Character"})]}),(0,n.jsxs)("div",{className:"vs-container",children:[(0,n.jsx)("img",{src:p.src,className:"App-vs",alt:"VS"}),(0,n.jsxs)("div",{className:"play-button-container",children:[(0,n.jsx)("button",{className:"start-game-button-text",onClick:()=>{W?(alert("Wallet Address: ".concat(W)),E(!0)):alert("Please connect your wallet")},children:"START GAME"}),c.map((e,t)=>(0,n.jsx)("button",{className:"play-button",onClick:()=>r({connector:e}),children:W?"CONNECTED":"CONNECT"},t))]})]}),(0,n.jsxs)("div",{className:"character right-character",children:[(0,n.jsx)("div",{className:"character-name",children:"Gizmo"}),(0,n.jsx)("img",{src:u.src,className:"App-right-character",alt:"Right Character"})]})]})})}}},function(e){e.O(0,[541,652,412,274,936,744],function(){return e(e.s=8095)}),_N_E=e.O()}]);